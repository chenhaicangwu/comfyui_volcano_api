# ComfyUI 火山引擎 API 插件文件说明

以下是 comfyui_volcano_api 插件中各文件的详细说明，包括其功能和重要性。

## 1. `__init__.py`

**功能**：插件的入口点，负责向 ComfyUI 注册节点。

**重要性**：这是 ComfyUI 识别和加载插件的必要文件。没有这个文件，ComfyUI 将无法识别插件中的节点。

**主要内容**：
- 从 `volcano_api.py` 导入节点类
- 定义 `NODE_CLASS_MAPPINGS` 字典，将节点类名映射到实际的类
- 定义 `NODE_DISPLAY_NAME_MAPPINGS` 字典，设置节点在 UI 中显示的名称
- 通过 `__all__` 导出必要的映射

## 2. `volcano_api.py`

**功能**：插件的核心功能实现文件，包含与火山引擎 API 通信的所有逻辑。

**重要性**：这是插件的主要代码文件，实现了所有的功能逻辑。

**主要内容**：
- `VolcanoChat` 类：处理与火山引擎 API 的通信
  - 初始化 OpenAI 客户端（火山引擎 API 兼容 OpenAI 接口）
  - 实现文本生成方法
  - 实现流式文本生成方法
- `VolcanoLLMLoader` 类：ComfyUI 节点，用于加载火山引擎 LLM 模型
  - 定义节点输入参数（endpoint_id、api_key 等）
  - 自动构建正确的 base_url
  - 测试与 API 的连接
- `VolcanoLLMPrompt` 类：ComfyUI 节点，用于发送提示并获取响应
  - 定义节点输入参数（prompt、system_prompt、生成参数等）
  - 调用 VolcanoChat 实例生成文本
  - 格式化并返回响应

## 3. `requirements.txt`

**功能**：列出插件所需的 Python 包依赖。

**重要性**：确保用户安装了正确版本的依赖库，避免兼容性问题。

**主要内容**：
- `openai>=1.0.0`：用于与火山引擎 API 通信（火山引擎 API 兼容 OpenAI 接口）
- `requests>=2.25.0`：用于发送 HTTP 请求，测试 API 连接

## 4. `README.md`

**功能**：提供插件的详细文档，包括安装方法、使用说明和故障排除指南。

**重要性**：帮助用户理解如何安装和使用插件，是用户第一个阅读的文件。

**主要内容**：
- 插件功能和特点介绍
- 安装方法（Git 克隆和手动下载）
- 节点详细说明（参数和输出）
- 使用示例和工作流
- 获取火山引擎 API 参数的指南
- 常见问题和解决方案
- 许可证信息和致谢

## 5. `install.py`

**功能**：自动安装插件所需的依赖库。

**重要性**：简化用户的安装过程，特别是对于不熟悉命令行的用户。

**主要内容**：
- 检查 Python 版本（要求 Python 3.8 或更高版本）
- 读取 requirements.txt 文件
- 检查已安装的包，安装缺失的依赖
- 提供彩色输出，使安装过程更直观
- 错误处理和安装状态反馈

## 6. `LICENSE`

**功能**：指定插件的许可证条款。

**重要性**：明确插件的法律使用条款，保护作者和用户的权益。

**主要内容**：
- MIT 许可证全文
- 版权声明（Copyright (c) 2025 宋歌）
- 权限授予和免责声明

## 7. `example_workflow.json`（未在提供的文件中）

**功能**：提供一个示例工作流，展示如何使用插件中的节点。

**重要性**：帮助用户快速上手，了解节点的连接方式和参数设置。

**主要内容**：
- 预配置的 ComfyUI 工作流
- 包含 VolcanoLLMLoader 和 VolcanoLLMPrompt 节点
- 示例参数和连接

## 总结

这些文件共同构成了一个完整的 ComfyUI 插件，使用户能够在 ComfyUI 中轻松连接和使用火山引擎的大语言模型 API。插件的设计注重易用性和错误处理，通过自动化配置和详细的文档，降低了用户使用的门槛。

上传到 GitHub 时，请确保包含所有这些文件，并在 README.md 中更新 GitHub 仓库 URL（将 "yourusername" 替换为您的实际 GitHub 用户名）。
